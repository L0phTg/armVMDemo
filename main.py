#!-*- coding: utf-8 -*-
from vm_thumb import *
import sys

 
#THUMB_CODE = b"\xd0\xb5\xd0\xbd\x13\x46\x00\x20\x01\x20\x79\x44\x14\xb0\x02\xaf\x0f\xaa"

#THUMB_CODE += b"\x24\x68\x09\x5c"               # ldr str

#THUMB_CODE += b"\x12\x90\x3e\x48\x08\x98"       # ldr str sp pc

import struct
My_Thumb_Code= struct.pack ("126B", *[
0x1f,0x49,0xf0,0xb5,0x79,0x44,0x09,0x68,0x87,0xb0,0x07,
0x46,0x0b,0x68,0x01,0xaa,0x0d,0x46,0x16,0x46,0x05,0x93,
0x1b,0x4b,0x7b,0x44,0x03,0xf1,0x10,0x0e,0x18,0x68,0x08,
0x33,0x53,0xf8,0x04,0x1c,0x73,0x45,0x14,0x46,0x03,0xc4,
0x22,0x46,0xf6,0xd1,0x3a,0x46,0x00,0x23,0x01,0x20,0x03,
0xf0,0x03,0x01,0x02,0x29,0x09,0xd0,0x03,0x29,0x0a,0xd0,
0x01,0x29,0x02,0xd0,0x14,0x78,0xf1,0x5c,0x08,0xe0,0x11,
0x78,0x01,0x31,0x04,0xe0,0x11,0x78,0x02,0x31,0x01,0xe0,
0x11,0x78,0x03,0x31,0xf4,0x5c,0x01,0x33,0xa1,0x42,0x18,
0xbf,0x00,0x20,0x10,0x2b,0x02,0xf1,0x01,0x02,0xe3,0xd1,
0x05,0x9a,0x2b,0x68,0x9a,0x42,0x01,0xd0,0xff,0xf7,0x0a,
0xef,0x07,0xb0,0xf0,0xbd])

arch = CS_ARCH_ARM
mode = CS_MODE_THUMB

#md = Cs(arch, mode)
md = Vs(arch, mode)


for insn in md.disasm(My_Thumb_Code, 0x80001000):
    sys.stdout.write('%s\t%s\n' % (insn.mnemonic, insn.op_str))
    for x in insn.bytes:
        sys.stdout.write('0x%02x ' % x)
    sys.stdout.write("\n")
  

#for insn in md.disasm(My_Thumb_Code, 0x80001000):
#    for x in insn.bytes: 
#        sys.stdout.write('0x%02x, ' % x)
#    sys.stdout.write("\n") 
          
